<loading-mask ng-if="vm.loadingInProgress" spinner="true"></loading-mask>
<div class="grid-block text-center vertical tasklist-container">
    <div class="grid-container menubar" ng-if="vm.tasksWithVideo.length === 0">
        <div class="grid-content">
            <div class="">No tasks available!</div>
        </div>
    </div>

    <div class="grid-block">
        <div class="grid-content task-list-table" ng-if="vm.preprocessingTasks != null">
            <h3>Importing</h3>
            <table class="hover table">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Range</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="task in vm.preprocessingTasks track by task.id">
                    <td>{{task.taskType}}</td>
                    <td>
                        {{task.video.name}}
                    </td>
                    <td>
                        {{task.frameRange.startFrameNumber}}-{{task.frameRange.endFrameNumber}}
                    </td>
                </tr>
                <tr ng-show="!vm.preprocessingTasks.length"
                    class="no-hover"
                >
                    <td colspan="3" class="no-tasks">No tasks</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="grid-content task-list-table">
            <h3>My Tasks</h3>
            <table class="hover table">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Range</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="task in vm.waitingTasks | myTasks:vm.user.id"
                    track-by="task.id">
                    <td ui-sref="^.task({taskId: task.id})">{{task.taskType}}</td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.video.name}}
                    </td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.frameRange.startFrameNumber}}-{{task.frameRange.endFrameNumber}}
                    </td>
                    <td>
                        <button ng-click="vm.removeAssignment(task, vm.user)"
                                tooltip="Remove my assignment from this task"
                        >
                            <i class="fa fa-times"></i>
                        </button>
                    </td>
                </tr>
                <tr ng-show="!vm.waitingTasks.length"
                    class="no-hover"
                >
                    <td colspan="3" class="no-tasks">No tasks</td>
                </tr>
                </tbody>
            </table>

            <h3>Unassigned Tasks</h3>
            <table class="hover table">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Range</th>
                </tr>
                </thead>
                <tbody>
                <tr ui-sref="^.task({taskId: task.id})" ng-repeat="task in vm.waitingTasks | unassignedTasks"
                    track-by="task.id">
                    <td>{{task.taskType}}</td>
                    <td>
                        {{task.video.name}}
                    </td>
                    <td>
                        {{task.frameRange.startFrameNumber}}-{{task.frameRange.endFrameNumber}}
                    </td>
                </tr>
                <tr ng-show="!vm.waitingTasks.length"
                    class="no-hover"
                >
                    <td colspan="3" class="no-tasks">No tasks</td>
                </tr>
                </tbody>
            </table>

            <h3>Assigned to someone else</h3>
            <table class="hover table">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Range</th>
                    <th>Assignee</th>
                    <th ng-show="vm.userPermissions.unassignPermission"></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="task in vm.waitingTasks | otherPeopleTasks:vm.user.id"
                    track-by="task.id">
                    <td ui-sref="^.task({taskId: task.id})">{{task.taskType}}</td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.video.name}}
                    </td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.frameRange.startFrameNumber}}-{{task.frameRange.endFrameNumber}}
                    </td>
                    <td ui-sref="^.task({taskId: task.id})">{{task.user.username}}</td>
                    <td ng-show="vm.userPermissions.unassignPermission">
                        <button ng-click="vm.removeAssignment(task, task.user)"
                                tooltip="Remove user assignment from this task"
                        >
                            <i class="fa fa-times"></i>
                        </button>
                    </td>
                </tr>
                <tr ng-show="!vm.waitingTasks.length"
                    class="no-hover"
                >
                    <td colspan="3" class="no-tasks">No tasks</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="grid-content task-list-table" ng-if="vm.labeledTasks != null">
            <h3>Finished</h3>
            <table class="hover table">
                <thead>
                <tr>
                    <th>Type</th>
                    <th>Title</th>
                    <th>Range</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="task in vm.labeledTasks track by task.id">
                    <td ui-sref="^.task({taskId: task.id})">{{task.taskType}}</td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.video.name}}
                    </td>
                    <td ui-sref="^.task({taskId: task.id})">
                        {{task.frameRange.startFrameNumber}}-{{task.frameRange.endFrameNumber}}

                    </td>
                    <td class="btn-column">
                        <div class="btn-container">
                            <button ui-sref="labeling.export({taskId: task.id})"
                                    tooltip="Export the finished task"
                            >
                                <i class="fa fa-external-link"></i>
                            </button>
                            <button ng-click="vm.reOpenTask(task)"
                                    tooltip="Reopen this Task for Labelers"
                            >
                                <i class="fa fa-pencil-square-o"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                <tr ng-show="!vm.labeledTasks.length"
                    class="no-hover"
                >
                    <td colspan="4" class="no-tasks">No tasks</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>